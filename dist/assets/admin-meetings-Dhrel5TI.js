import{j as e,u as C,a as S,b as k}from"./query-vendor-6bJJjEwk.js";import{R as O,a as y}from"./react-vendor-WvRYOV97.js";import{b as ce,X,A as U,z as h,D as de,h as me,i as ue,S as xe,j as R,k as L,l as B,a as Z,C as ee,m as te,n as se,o as F,p as he,q as ge,P as pe,E as be,r as ye,s as Q,t as ae,u as fe,v as ve,w as we,U as G,x as je}from"./ui-vendor-DsDpDu1Q.js";import{s as g,L as $}from"./admin-r4uB3Efm.js";const Ne={primary:"bg-gradient-to-r from-cyan-500 to-purple-500 text-white hover:shadow-lg hover:shadow-cyan-500/25 hover:scale-105",secondary:"bg-white/5 border border-gray-600 text-gray-300 hover:bg-white/10 hover:border-cyan-500/50 hover:text-white",danger:"bg-red-500/10 border border-red-500/50 text-red-400 hover:bg-red-500/20 hover:border-red-500",success:"bg-green-500/10 border border-green-500/50 text-green-400 hover:bg-green-500/20 hover:border-green-500",ghost:"text-gray-400 hover:text-cyan-400 hover:bg-white/5"},_e={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},E=O.forwardRef(({variant:t="primary",size:s="md",isLoading:a=!1,icon:r,fullWidth:n=!1,disabled:i,children:l,className:u="",...o},x)=>{const b="inline-flex items-center justify-center gap-2 rounded-lg font-semibold transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",p=n?"w-full":"",f=i||a;return e.jsx("button",{ref:x,disabled:f,className:`${b} ${Ne[t]} ${_e[s]} ${p} ${u}`,...o,children:a?e.jsxs(e.Fragment,{children:[e.jsx(ce,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Chargement..."})]}):e.jsxs(e.Fragment,{children:[r&&e.jsx("span",{className:"inline-flex",children:r}),l]})})});E.displayName="Button";const Se={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl",full:"max-w-full mx-4"},P=({isOpen:t,onClose:s,title:a,children:r,size:n="md",showCloseButton:i=!0})=>(y.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),y.useEffect(()=>{const l=u=>{u.key==="Escape"&&t&&s()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[t,s]),t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm transition-opacity","aria-hidden":"true",onClick:s}),e.jsxs("div",{className:`
            relative bg-[#0A0A0B] border border-gray-700/50 rounded-2xl shadow-xl
            transform transition-all w-full ${Se[n]}
            animate-modal-enter
          `,children:[(a||i)&&e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700/50",children:[a&&e.jsx("h3",{id:"modal-title",className:"text-xl font-bold text-white",children:a}),i&&e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors p-1 rounded-lg hover:bg-white/5","aria-label":"Fermer",children:e.jsx(X,{size:24})})]}),e.jsx("div",{className:"p-6",children:r})]})]}),e.jsx("style",{children:`
        @keyframes modal-enter {
          from {
            opacity: 0;
            transform: scale(0.95) translateY(-10px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }

        .animate-modal-enter {
          animation: modal-enter 0.2s ease-out;
        }
      `})]}):null),_=O.forwardRef(({label:t,error:s,icon:a,helperText:r,className:n="",id:i,required:l,...u},o)=>{const x=i||t?.toLowerCase().replace(/\s+/g,"-");return e.jsxs("div",{className:"w-full",children:[t&&e.jsxs("label",{htmlFor:x,className:"block text-sm font-medium text-gray-300 mb-2",children:[t,l&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[a&&e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400",children:a})}),e.jsx("input",{ref:o,id:x,className:`
              block w-full rounded-lg bg-white/5 text-white placeholder-gray-500
              border ${s?"border-red-500":"border-gray-600"}
              focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent
              transition-all duration-300
              disabled:opacity-50 disabled:cursor-not-allowed
              ${a?"pl-10":"pl-3"}
              pr-3 py-2.5
              ${n}
            `,"aria-invalid":!!s,"aria-describedby":s?`${x}-error`:r?`${x}-helper`:void 0,...u})]}),r&&!s&&e.jsx("p",{id:`${x}-helper`,className:"mt-1.5 text-sm text-gray-400",children:r}),s&&e.jsxs("p",{id:`${x}-error`,className:"mt-1.5 text-sm text-red-400 flex items-center gap-1",children:[e.jsx(U,{size:14}),s]})]})});_.displayName="Input";const re=O.forwardRef(({label:t,error:s,helperText:a,showCharCount:r=!1,className:n="",id:i,required:l,maxLength:u,value:o,...x},b)=>{const p=i||t?.toLowerCase().replace(/\s+/g,"-"),f=o?.toString().length||0;return e.jsxs("div",{className:"w-full",children:[t&&e.jsxs("label",{htmlFor:p,className:"block text-sm font-medium text-gray-300 mb-2",children:[t,l&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("textarea",{ref:b,id:p,value:o,maxLength:u,className:`
            block w-full rounded-lg bg-white/5 text-white placeholder-gray-500
            border ${s?"border-red-500":"border-gray-600"}
            focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent
            transition-all duration-300
            disabled:opacity-50 disabled:cursor-not-allowed
            px-3 py-2.5
            resize-vertical
            ${n}
          `,"aria-invalid":!!s,"aria-describedby":s?`${p}-error`:a?`${p}-helper`:void 0,...x}),e.jsxs("div",{className:"mt-1.5 flex items-center justify-between",children:[a&&!s&&e.jsx("p",{id:`${p}-helper`,className:"text-sm text-gray-400",children:a}),s&&e.jsxs("p",{id:`${p}-error`,className:"text-sm text-red-400 flex items-center gap-1",children:[e.jsx(U,{size:14}),s]}),r&&u&&e.jsxs("p",{className:`text-sm ml-auto ${f>u*.9?"text-yellow-400":"text-gray-500"}`,children:[f," / ",u]})]})]})});re.displayName="Textarea";const ke=async t=>{let s=g.from("meetings").select(`
      *,
      meeting_services (
        name,
        color
      )
    `).order("meeting_date",{ascending:!1}).order("meeting_time",{ascending:!1});t?.status&&(s=s.eq("status",t.status)),t?.service_id&&(s=s.eq("service_id",t.service_id)),t?.date_from&&(s=s.gte("meeting_date",t.date_from)),t?.date_to&&(s=s.lte("meeting_date",t.date_to));const{data:a,error:r}=await s;if(r)throw r;return a||[]},Ce=async(t=10)=>{const s=new Date().toISOString().split("T")[0],{data:a,error:r}=await g.from("meetings").select(`
      *,
      meeting_services (
        name,
        color
      )
    `).gte("meeting_date",s).in("status",["pending","confirmed"]).order("meeting_date").order("meeting_time").limit(t);if(r)throw r;return a||[]},De=async()=>{const{data:t,error:s}=await g.from("meetings").select("status");if(s)throw s;const a={total:t?.length||0,pending:0,confirmed:0,completed:0,cancelled:0,no_show:0};return t?.forEach(r=>{switch(r.status){case"pending":a.pending++;break;case"confirmed":a.confirmed++;break;case"completed":a.completed++;break;case"cancelled":a.cancelled++;break;case"no_show":a.no_show++;break}}),a},Ee=async(t,s,a)=>{const{data:r,error:n}=await g.from("meetings").select("id, meeting_time, duration").eq("meeting_date",t).in("status",["pending","confirmed"]);if(n)throw n;if(!r||r.length===0)return!0;const i=J(s),l=i+a;for(const u of r){const o=J(u.meeting_time),x=o+u.duration;if(i>=o&&i<x||l>o&&l<=x||i<=o&&l>=x)return!1}return!0},qe=async t=>{if(!await Ee(t.meeting_date,t.meeting_time,t.duration))throw new Error("Ce cr√©neau horaire n'est plus disponible");const{data:a,error:r}=await g.from("meetings").insert({service_id:t.service_id,meeting_date:t.meeting_date,meeting_time:t.meeting_time,duration:t.duration,client_name:t.client_name,client_email:t.client_email,client_phone:t.client_phone,client_country_code:t.client_country_code,client_company:t.client_company||null,client_notes:t.client_notes||null,meeting_channel:t.meeting_channel||"zoom",meeting_link:t.meeting_link||null,status:"pending"}).select(`
      *,
      meeting_services (
        name,
        color
      )
    `).single();if(r)throw r;if(!a)throw new Error("Erreur lors de la cr√©ation du rendez-vous");return a},Ae=async(t,s)=>{const{data:a,error:r}=await g.from("meetings").update({...s,updated_at:new Date().toISOString()}).eq("id",t).select(`
      *,
      meeting_services (
        name,
        color
      )
    `).single();if(r)throw r;if(!a)throw new Error("Rendez-vous non trouv√©");return a},Me=async t=>{const{error:s}=await g.from("meetings").delete().eq("id",t);if(s)throw s},Fe=async(t,s)=>Ae(t,{status:s});function J(t){const[s,a]=t.split(":").map(Number);return s*60+a}const j={all:["meetings"],list:t=>["meetings","list",t],detail:t=>["meetings",t],byDate:t=>["meetings","date",t],upcoming:["meetings","upcoming"],stats:["meetings","stats"],slotAvailable:(t,s)=>["meetings","slot-available",t,s]},$e=t=>C({queryKey:j.list(t),queryFn:()=>ke(t)}),Te=(t=5)=>C({queryKey:j.upcoming,queryFn:()=>Ce(t),refetchInterval:6e4}),ze=()=>C({queryKey:j.stats,queryFn:De,staleTime:6e4}),Tt=()=>{const t=S();return k({mutationFn:s=>qe(s),onSuccess:s=>{t.invalidateQueries({queryKey:j.all}),t.invalidateQueries({queryKey:j.stats}),t.invalidateQueries({queryKey:j.byDate(s.meeting_date)}),h.success("Rendez-vous cr√©√© ! Vous recevrez une confirmation par email.")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},Ke=()=>{const t=S();return k({mutationFn:s=>Me(s),onSuccess:()=>{t.invalidateQueries({queryKey:j.all}),t.invalidateQueries({queryKey:j.stats}),h.success("Rendez-vous supprim√©")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},Ie=()=>{const t=S();return k({mutationFn:({id:s,status:a,reason:r})=>Fe(s,a),onSuccess:s=>{t.invalidateQueries({queryKey:j.all}),t.invalidateQueries({queryKey:j.detail(s.id)}),t.invalidateQueries({queryKey:j.stats}),t.invalidateQueries({queryKey:j.upcoming});const a={pending:"Rendez-vous en attente",confirmed:"Rendez-vous confirm√©",completed:"Rendez-vous termin√©",cancelled:"Rendez-vous annul√©",no_show:"Marqu√© comme absence"};h.success(a[s.status])},onError:s=>{h.error(`Erreur: ${s.message}`)}})},Re=async()=>{const{data:t,error:s}=await g.from("meeting_services").select("*").order("name");if(s)throw s;return t||[]},Le=async()=>{const{data:t,error:s}=await g.from("meeting_services").select("*").eq("is_active",!0).order("name");if(s)throw s;return t||[]},Be=async t=>{const{data:s,error:a}=await g.from("meeting_services").insert({name:t.name,description:t.description||null,duration:t.duration,category:t.category,color:t.color,icon:t.icon||null,is_active:!0}).select().single();if(a)throw a;if(!s)throw new Error("Erreur lors de la cr√©ation du service");return s},Qe=async(t,s)=>{const{data:a,error:r}=await g.from("meeting_services").update({...s,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;if(!a)throw new Error("Service non trouv√©");return a},Pe=async t=>{const{error:s}=await g.from("meeting_services").delete().eq("id",t);if(s)throw s},Oe=async(t,s)=>{const{data:a,error:r}=await g.from("meeting_services").update({is_active:s,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;if(!a)throw new Error("Service non trouv√©");return a},N={all:["meeting-services"],active:["meeting-services","active"],detail:t=>["meeting-services",t],byCategory:t=>["meeting-services","category",t]},Ue=()=>C({queryKey:N.active,queryFn:Le,staleTime:300*1e3}),Ve=()=>C({queryKey:N.all,queryFn:Re}),Ye=()=>{const t=S();return k({mutationFn:s=>Be(s),onSuccess:()=>{t.invalidateQueries({queryKey:N.all}),t.invalidateQueries({queryKey:N.active}),h.success("Service cr√©√© avec succ√®s")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},Ge=()=>{const t=S();return k({mutationFn:s=>Qe(s),onSuccess:s=>{t.invalidateQueries({queryKey:N.all}),t.invalidateQueries({queryKey:N.active}),t.invalidateQueries({queryKey:N.detail(s.id)}),h.success("Service mis √† jour")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},Je=()=>{const t=S();return k({mutationFn:s=>Pe(s),onSuccess:()=>{t.invalidateQueries({queryKey:N.all}),t.invalidateQueries({queryKey:N.active}),h.success("Service supprim√©")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},He=()=>{const t=S();return k({mutationFn:({id:s,isActive:a})=>Oe(s,a),onSuccess:()=>{t.invalidateQueries({queryKey:N.all}),t.invalidateQueries({queryKey:N.active}),h.success("Statut mis √† jour")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},We=t=>(typeof t=="string"?new Date(t):t).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),H=t=>t.substring(0,5),Xe=t=>["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"][t],Ze=(t,s)=>{const a=new Date(t,s-1,1),r=[];for(;a.getMonth()===s-1;)r.push(new Date(a)),a.setDate(a.getDate()+1);return r},et=(t,s)=>new Date(t,s-1,1).getDay(),tt=(t,s)=>{if(!t||t.length===0)return"";const a=s.map(n=>`"${n.label}"`).join(","),r=t.map(n=>s.map(i=>{let l=n[i.key];return i.format&&(l=i.format(l,n)),typeof l=="string"&&(l=l.replace(/"/g,'""'),l=l.replace(/\n/g," ")),`"${l||""}"`}).join(","));return[a,...r].join(`
`)},st=(t,s,a)=>{const r=tt(t,s),n=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(i.download!==void 0){const l=URL.createObjectURL(n);i.setAttribute("href",l),i.setAttribute("download",`${a}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}},at=()=>[{key:"id",label:"ID"},{key:"meeting_date",label:"Date",format:t=>new Date(t).toLocaleDateString("fr-FR")},{key:"meeting_time",label:"Heure"},{key:"duration",label:"Dur√©e (min)"},{key:"client_name",label:"Client"},{key:"client_email",label:"Email"},{key:"client_phone",label:"T√©l√©phone"},{key:"client_country_code",label:"Pays"},{key:"client_company",label:"Entreprise"},{key:"service_name",label:"Service",format:(t,s)=>s.meeting_services?.name||"N/A"},{key:"meeting_channel",label:"Canal"},{key:"status",label:"Statut",format:t=>({pending:"En attente",confirmed:"Confirm√©",completed:"Termin√©",cancelled:"Annul√©",no_show:"Absent"})[t]||t},{key:"created_at",label:"Cr√©√© le",format:t=>new Date(t).toLocaleString("fr-FR")}],rt=(t,s)=>{const a=`rendez-vous-${new Date().toISOString().split("T")[0]}`,r=at();st(t,r,s||a)},nt=(t,s,a)=>{let r=`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <style>
        @page { size: A4 landscape; margin: 1cm; }
        body { 
          font-family: Arial, sans-serif; 
          padding: 20px;
          color: #0a0a0b;
        }
        .header {
          text-align: center;
          margin-bottom: 30px;
          border-bottom: 3px solid #06b6d4;
          padding-bottom: 20px;
        }
        .title { 
          font-size: 28px; 
          font-weight: bold;
          color: #06b6d4;
          margin-bottom: 10px;
        }
        .subtitle {
          font-size: 14px;
          color: #666;
        }
        table { 
          border-collapse: collapse; 
          width: 100%;
          font-size: 11px;
        }
        th { 
          background-color: #06b6d4; 
          color: white; 
          font-weight: bold; 
          padding: 10px 8px; 
          text-align: left;
          border: 1px solid #0891b2;
        }
        td { 
          padding: 8px; 
          border: 1px solid #ddd;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .status-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 10px;
          font-weight: bold;
          display: inline-block;
        }
        .status-pending { background-color: #fef3c7; color: #92400e; }
        .status-confirmed { background-color: #d1fae5; color: #065f46; }
        .status-completed { background-color: #dbeafe; color: #1e40af; }
        .status-cancelled { background-color: #fee2e2; color: #991b1b; }
        .footer {
          margin-top: 30px;
          text-align: center;
          font-size: 10px;
          color: #666;
          border-top: 1px solid #ddd;
          padding-top: 10px;
        }
        @media print {
          .no-print { display: none; }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="title">${a||"Rendez-vous"}</div>
        <div class="subtitle">G√©n√©r√© le ${new Date().toLocaleString("fr-FR")}</div>
      </div>
      
      <table>
        <thead>
          <tr>
  `;return s.forEach(n=>{r+=`<th>${n.label}</th>`}),r+="</tr></thead><tbody>",t.forEach(n=>{r+="<tr>",s.forEach(i=>{let l=n[i.key];if(i.format&&(l=i.format(l,n)),i.key==="status"){const u=`status-${n[i.key]||"pending"}`;r+=`<td><span class="status-badge ${u}">${l||""}</span></td>`}else r+=`<td>${l||""}</td>`}),r+="</tr>"}),r+=`
        </tbody>
      </table>
      
      <div class="footer">
        <p>Total: ${t.length} rendez-vous</p>
      </div>
    </body>
    </html>
  `,r},it=(t,s,a)=>{const r=nt(t,s,a),n=window.open("","_blank");n&&(n.document.write(r),n.document.close(),n.onload=()=>{n.focus(),n.print()})},lt=()=>[{key:"meeting_date",label:"Date",format:t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"})},{key:"meeting_time",label:"Heure"},{key:"client_name",label:"Client"},{key:"client_email",label:"Email"},{key:"client_phone",label:"T√©l."},{key:"service_name",label:"Service",format:(t,s)=>s.meeting_services?.name||"N/A"},{key:"meeting_channel",label:"Canal"},{key:"status",label:"Statut",format:t=>({pending:"En attente",confirmed:"Confirm√©",completed:"Termin√©",cancelled:"Annul√©",no_show:"Absent"})[t]||t}],ot=(t,s)=>{const a=`Rendez-vous - ${new Date().toLocaleDateString("fr-FR")}`,r=lt();it(t,r,s||a)},ct=({data:t,filename:s,title:a,disabled:r=!1,className:n=""})=>{const[i,l]=y.useState(!1),[u,o]=y.useState(!1),x=async b=>{if(!t||t.length===0){h.error("Aucune donn√©e √† exporter");return}o(!0);try{const p=s||`export-${Date.now()}`;switch(b){case"csv":rt(t,p),h.success("Export CSV termin√© !");break;case"pdf":ot(t,a),h.success("Export PDF lanc√© !");break}setTimeout(()=>{l(!1)},500)}catch(p){console.error("Erreur export:",p),h.error("Erreur lors de l'export")}finally{setTimeout(()=>o(!1),1e3)}};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>l(!0),disabled:r||u,className:`
          flex items-center gap-2 px-4 py-2 rounded-lg font-medium
          transition-all duration-200
          ${r||u?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-cyan-500 text-white hover:bg-cyan-600 active:scale-95"}
          ${n}
        `,children:[e.jsx(de,{className:`w-4 h-4 ${u?"animate-bounce":""}`}),e.jsx("span",{children:u?"Export...":"Exporter"})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[200] p-4",onClick:()=>!u&&l(!1),children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-white/10 max-w-md w-full animate-in fade-in zoom-in duration-200",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-white/10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Exporter les donn√©es"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Choisissez le format d'export"})]}),e.jsx("button",{onClick:()=>l(!1),disabled:u,className:"p-2 hover:bg-white/10 rounded-lg transition-colors disabled:opacity-50",children:e.jsx(X,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsxs("button",{onClick:()=>x("csv"),disabled:u,className:"w-full flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed group hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-lg flex items-center justify-center group-hover:bg-green-500/20 transition-colors",children:e.jsx(me,{className:"w-6 h-6 text-green-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-medium",children:"Exporter CSV"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Format tableur, compatible Excel"})]})]}),e.jsxs("button",{onClick:()=>x("pdf"),disabled:u,className:"w-full flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed group hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-lg flex items-center justify-center group-hover:bg-red-500/20 transition-colors",children:e.jsx(ue,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-medium",children:"Exporter PDF"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Document imprimable et partageable"})]})]})]}),e.jsx("div",{className:"p-6 border-t border-white/10",children:e.jsx("button",{onClick:()=>l(!1),disabled:u,className:"w-full px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors disabled:opacity-50",children:"Annuler"})})]})})]})},W=t=>{switch(t){case"zoom":return"üé• Zoom";case"google_meet":return"üìπ Google Meet";case"microsoft_teams":return"üë• Teams";case"whatsapp_video":return"üí¨ WhatsApp";case"phone":return"üìû T√©l√©phone";case"skype":return"üìû Skype";case"in_person":return"üè¢ En personne";default:return"‚ùì Non d√©fini"}},dt=()=>{const[t,s]=y.useState({}),[a,r]=y.useState(""),[n,i]=y.useState(null),[l,u]=y.useState(!1),[o,x]=y.useState(!1),[b,p]=y.useState("date"),[f,m]=y.useState("desc"),{data:v,isLoading:d}=$e(t),T=Ie(),q=Ke(),ne=v?.filter(c=>{if(!a)return!0;const w=a.toLowerCase();return c.client_name.toLowerCase().includes(w)||c.client_email.toLowerCase().includes(w)||c.client_phone.includes(w)}),I=c=>{b===c?m(f==="asc"?"desc":"asc"):(p(c),m("desc"))},A=[...ne||[]].sort((c,w)=>{let D=0;switch(b){case"date":const le=new Date(c.meeting_date+" "+c.meeting_time),oe=new Date(w.meeting_date+" "+w.meeting_time);D=le.getTime()-oe.getTime();break;case"time":D=c.meeting_time.localeCompare(w.meeting_time);break;case"client":D=c.client_name.localeCompare(w.client_name);break;case"status":D=c.status.localeCompare(w.status);break}return f==="asc"?D:-D}),V=(c,w)=>{T.mutate({id:c,status:w})},ie=()=>{n&&q.mutate(n.id,{onSuccess:()=>{x(!1),i(null)}})},Y=c=>{const w={pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",confirmed:"bg-green-500/20 text-green-400 border-green-500/30",completed:"bg-blue-500/20 text-blue-400 border-blue-500/30",cancelled:"bg-red-500/20 text-red-400 border-red-500/30",no_show:"bg-gray-500/20 text-gray-400 border-gray-500/30"},D={pending:"En attente",confirmed:"Confirm√©",completed:"Termin√©",cancelled:"Annul√©",no_show:"Absence"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs border ${w[c]}`,children:D[c]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Rechercher par nom, email, t√©l√©phone...",value:a,onChange:c=>r(c.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-500"})]})}),e.jsxs("select",{value:t.status||"",onChange:c=>s({...t,status:c.target.value}),className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"confirmed",children:"Confirm√©s"}),e.jsx("option",{value:"completed",children:"Termin√©s"}),e.jsx("option",{value:"cancelled",children:"Annul√©s"}),e.jsx("option",{value:"no_show",children:"Absences"})]}),e.jsx(ct,{data:A||[],filename:`rendez-vous-${new Date().toISOString().split("T")[0]}`,title:"Liste des rendez-vous",disabled:!A||A.length===0})]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[A?.length||0," rendez-vous trouv√©(s)"]})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 overflow-hidden",children:d?e.jsx("div",{className:"p-12",children:e.jsx($,{})}):A&&A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase cursor-pointer hover:text-cyan-400 transition-colors select-none",onClick:()=>I("date"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Date",b==="date"?f==="asc"?e.jsx(R,{className:"w-4 h-4 text-cyan-400"}):e.jsx(L,{className:"w-4 h-4 text-cyan-400"}):e.jsx(B,{className:"w-4 h-4 opacity-50"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase cursor-pointer hover:text-cyan-400 transition-colors select-none",onClick:()=>I("client"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Client",b==="client"?f==="asc"?e.jsx(R,{className:"w-4 h-4 text-cyan-400"}):e.jsx(L,{className:"w-4 h-4 text-cyan-400"}):e.jsx(B,{className:"w-4 h-4 opacity-50"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Service"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Contact"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase",children:"Canal"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase cursor-pointer hover:text-cyan-400 transition-colors select-none",onClick:()=>I("status"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Statut",b==="status"?f==="asc"?e.jsx(R,{className:"w-4 h-4 text-cyan-400"}):e.jsx(L,{className:"w-4 h-4 text-cyan-400"}):e.jsx(B,{className:"w-4 h-4 opacity-50"})]})}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:A.map(c=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:new Date(c.meeting_date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"})}),e.jsx("p",{className:"text-sm text-gray-400",children:H(c.meeting_time)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.client_name}),c.client_company&&e.jsx("p",{className:"text-sm text-gray-400",children:c.client_company})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-white",children:c.meeting_services?.name||"N/A"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[c.duration," min"]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-gray-300",children:c.client_email}),e.jsxs("p",{className:"text-gray-400",children:[c.client_country_code," ",c.client_phone]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-300",children:W(c.meeting_channel)})}),e.jsx("td",{className:"px-6 py-4",children:Y(c.status)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>{i(c),u(!0)},className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Voir d√©tails",children:e.jsx(Z,{className:"w-5 h-5 text-gray-400"})}),c.status==="pending"&&e.jsx("button",{onClick:()=>V(c.id,"confirmed"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Confirmer",children:e.jsx(ee,{className:"w-5 h-5 text-green-400"})}),["pending","confirmed"].includes(c.status)&&e.jsx("button",{onClick:()=>V(c.id,"cancelled"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Annuler",children:e.jsx(te,{className:"w-5 h-5 text-red-400"})}),e.jsx("button",{onClick:()=>{i(c),x(!0)},className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Supprimer",children:e.jsx(se,{className:"w-5 h-5 text-red-400"})})]})})]},c.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Aucun rendez-vous trouv√©"})]})}),l&&n&&e.jsx(P,{isOpen:l,onClose:()=>u(!1),title:"D√©tails du rendez-vous",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Service"}),e.jsx("p",{className:"text-white font-medium",children:n.meeting_services?.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Date"}),e.jsx("p",{className:"text-white",children:We(n.meeting_date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Heure"}),e.jsx("p",{className:"text-white",children:H(n.meeting_time)})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Client"}),e.jsx("p",{className:"text-white",children:n.client_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Email"}),e.jsx("p",{className:"text-white",children:n.client_email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"T√©l√©phone"}),e.jsxs("p",{className:"text-white",children:[n.client_country_code," ",n.client_phone]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Canal de communication"}),e.jsx("p",{className:"text-white font-medium",children:W(n.meeting_channel)})]}),n.client_notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Notes client"}),e.jsx("p",{className:"text-white",children:n.client_notes})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Statut"}),Y(n.status)]})]})}),o&&e.jsx(P,{isOpen:o,onClose:()=>x(!1),title:"Supprimer le rendez-vous",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-300",children:"√ätes-vous s√ªr de vouloir supprimer ce rendez-vous ?"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Cette action est irr√©versible."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:()=>x(!1),variant:"secondary",className:"flex-1",children:"Annuler"}),e.jsx(E,{onClick:ie,variant:"danger",className:"flex-1",disabled:q.isPending,children:q.isPending?"Suppression...":"Supprimer"})]})]})})]})},mt=async()=>{const{data:t,error:s}=await g.from("meeting_availability").select("*").eq("is_available",!0).order("day_of_week",{ascending:!0}).order("start_time",{ascending:!0});if(s)throw s;return t||[]},ut=async()=>{const{data:t,error:s}=await g.from("meeting_blocked_dates").select("*").order("blocked_date",{ascending:!0});if(s)throw s;return t||[]},xt=async t=>{const{data:s,error:a}=await g.from("meeting_blocked_dates").insert([t]).select().single();if(a)throw a;return s},ht=async t=>{const{error:s}=await g.from("meeting_blocked_dates").delete().eq("id",t);if(s)throw s},gt=async(t,s)=>{const a=new Date(t,s-1,1).toISOString().split("T")[0],r=new Date(t,s,0).toISOString().split("T")[0],[n,i,l]=await Promise.all([g.from("meeting_availability").select("*").eq("is_available",!0),g.from("meeting_blocked_dates").select("*").gte("blocked_date",a).lte("blocked_date",r),g.from("meetings").select("*").gte("meeting_date",a).lte("meeting_date",r).in("status",["pending","confirmed"])]);if(n.error)throw n.error;if(i.error)throw i.error;if(l.error)throw l.error;return{availabilities:n.data||[],blockedDates:i.data||[],meetings:l.data||[]}},M={all:["availability"],byDay:t=>["availability","day",t],blockedDates:["blocked-dates"],upcomingBlocked:["blocked-dates","upcoming"],isBlocked:t=>["blocked-dates","is-blocked",t],monthSchedule:(t,s)=>["schedule","month",t,s]},pt=()=>C({queryKey:M.all,queryFn:mt,staleTime:300*1e3}),bt=()=>C({queryKey:M.blockedDates,queryFn:ut}),yt=(t,s)=>C({queryKey:M.monthSchedule(t,s),queryFn:()=>gt(t,s),staleTime:6e4}),ft=()=>{const t=S();return k({mutationFn:s=>xt(s),onSuccess:()=>{t.invalidateQueries({queryKey:M.blockedDates}),t.invalidateQueries({queryKey:M.upcomingBlocked}),h.success("Date bloqu√©e")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},vt=()=>{const t=S();return k({mutationFn:s=>ht(s),onSuccess:()=>{t.invalidateQueries({queryKey:M.blockedDates}),t.invalidateQueries({queryKey:M.upcomingBlocked}),h.success("Date d√©bloqu√©e")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},wt=()=>{const t=new Date,[s,a]=y.useState(t.getFullYear()),[r,n]=y.useState(t.getMonth()+1),{data:i,isLoading:l}=yt(s,r),u=Ze(s,r),o=et(s,r),x=()=>{r===1?(n(12),a(s-1)):n(r-1)},b=()=>{r===12?(n(1),a(s+1)):n(r+1)},p=m=>{const v=m.toISOString().split("T")[0];return i?.meetings.filter(d=>d.meeting_date===v)||[]},f=m=>{const v=m.toISOString().split("T")[0];return i?.blockedDates.some(d=>d.blocked_date===v)};return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white",children:[Xe(r-1)," ",s]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:x,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(he,{className:"w-5 h-5 text-white"})}),e.jsx("button",{onClick:b,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(ge,{className:"w-5 h-5 text-white"})})]})]}),l?e.jsx($,{}):e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"].map(m=>e.jsx("div",{className:"text-center text-gray-400 text-sm font-medium py-2",children:m},m)),Array.from({length:o}).map((m,v)=>e.jsx("div",{},`empty-${v}`)),u.map(m=>{const v=p(m),d=f(m),T=m.toDateString()===new Date().toDateString();return e.jsxs("div",{className:`min-h-24 p-2 rounded-lg border ${T?"border-cyan-500 bg-cyan-500/10":d?"border-red-500/30 bg-red-500/5":"border-white/10 bg-white/5"} hover:bg-white/10 transition-colors`,children:[e.jsx("p",{className:`text-sm font-medium mb-2 ${T?"text-cyan-400":"text-white"}`,children:m.getDate()}),d&&e.jsx("p",{className:"text-xs text-red-400",children:"Bloqu√©"}),v.length>0&&e.jsxs("div",{className:"space-y-1",children:[v.slice(0,2).map(q=>e.jsx("div",{className:"text-xs px-2 py-1 rounded bg-cyan-500/20 text-cyan-300 truncate",title:q.client_name,children:q.meeting_time.substring(0,5)},q.id)),v.length>2&&e.jsxs("p",{className:"text-xs text-gray-400",children:["+",v.length-2," autre(s)"]})]})]},m.toISOString())})]})]})},jt=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),[n,i]=y.useState({name:"",description:"",duration:60,category:"",color:"#06b6d4",icon:"Calendar"}),{data:l,isLoading:u}=Ve(),o=Ye(),x=Ge(),b=Je(),p=He(),f=async d=>{d.preventDefault(),a?await x.mutateAsync({id:a.id,...n}):await o.mutateAsync(n),s(!1),m()},m=()=>{i({name:"",description:"",duration:60,category:"",color:"#06b6d4",icon:"Calendar"}),r(null)},v=d=>{r(d),i({name:d.name,description:d.description||"",duration:d.duration,category:d.category,color:d.color,icon:d.icon||"Calendar"}),s(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Services"}),e.jsxs(E,{onClick:()=>s(!0),className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Nouveau service"]})]}),u?e.jsx($,{}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l?.map(d=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6 hover:bg-white/10 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:d.color+"20"},children:e.jsx("div",{style:{color:d.color},children:"üìÖ"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:d.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:[d.duration," min"]})]})]}),e.jsx("button",{onClick:()=>p.mutate({id:d.id,isActive:!d.is_active}),className:"p-2 hover:bg-white/10 rounded-lg",children:d.is_active?e.jsx(Z,{className:"w-5 h-5 text-green-400"}):e.jsx(be,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:d.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>v(d),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-white/5 hover:bg-white/10 rounded-lg text-white transition-colors",children:[e.jsx(ye,{className:"w-4 h-4"}),"Modifier"]}),e.jsx("button",{onClick:()=>{confirm("Supprimer ce service ?")&&b.mutate(d.id)},className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 rounded-lg text-red-400 transition-colors",children:e.jsx(se,{className:"w-4 h-4"})})]})]},d.id))}),e.jsx(P,{isOpen:t,onClose:()=>{s(!1),m()},title:a?"Modifier le service":"Nouveau service",children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx(_,{label:"Nom du service",value:n.name,onChange:d=>i({...n,name:d.target.value}),required:!0}),e.jsx(re,{label:"Description",value:n.description,onChange:d=>i({...n,description:d.target.value}),rows:3}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(_,{label:"Dur√©e (minutes)",type:"number",value:n.duration,onChange:d=>i({...n,duration:parseInt(d.target.value)}),min:15,max:240,required:!0}),e.jsx(_,{label:"Couleur",type:"color",value:n.color,onChange:d=>i({...n,color:d.target.value})})]}),e.jsx(_,{label:"Cat√©gorie",value:n.category,onChange:d=>i({...n,category:d.target.value}),placeholder:"web-development, digital-strategy...",required:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{s(!1),m()},className:"flex-1",children:"Annuler"}),e.jsx(E,{type:"submit",className:"flex-1",disabled:o.isPending||x.isPending,children:a?"Mettre √† jour":"Cr√©er"})]})]})})]})},Nt=async()=>{const{data:t,error:s}=await g.from("meeting_settings").select("*").order("setting_key",{ascending:!0});if(s)throw s;return t||[]},_t=async()=>{const t=await Nt(),s={buffer_time:15,max_advance_days:90,min_advance_hours:24,slot_duration:45,admin_email:"contact@leonce-ouattara.com",timezone:"Africa/Abidjan"};return t.forEach(a=>{const r=a.setting_key,n=a.setting_value;r==="admin_email"||r==="timezone"?s[r]=n:s[r]=parseInt(n,10)}),s},St=async t=>{const s=Object.entries(t).map(([n,i])=>g.from("meeting_settings").update({setting_value:i}).eq("setting_key",n)),r=(await Promise.all(s)).find(n=>n.error);if(r)throw r.error},K={all:["meeting-settings"],formatted:["meeting-settings","formatted"],validation:["meeting-settings","validation"]},kt=()=>C({queryKey:K.formatted,queryFn:_t,staleTime:300*1e3}),Ct=()=>{const t=S();return k({mutationFn:s=>St(s),onSuccess:()=>{t.invalidateQueries({queryKey:K.all}),t.invalidateQueries({queryKey:K.formatted}),t.invalidateQueries({queryKey:K.validation}),h.success("Param√®tres mis √† jour")},onError:s=>{h.error(`Erreur: ${s.message}`)}})},Dt=()=>{const{data:t}=pt(),{data:s}=bt(),{data:a}=kt(),r=Ct(),n=ft(),i=vt(),[l,u]=y.useState(""),[o,x]=y.useState({buffer_time:a?.buffer_time||15,max_advance_days:a?.max_advance_days||90,min_advance_hours:a?.min_advance_hours||24,slot_duration:a?.slot_duration||45}),b=async()=>{await r.mutateAsync({buffer_time:o.buffer_time.toString(),max_advance_days:o.max_advance_days.toString(),min_advance_hours:o.min_advance_hours.toString(),slot_duration:o.slot_duration.toString()})},p=async()=>{l&&(await n.mutateAsync({blocked_date:l,reason:"Date bloqu√©e manuellement"}),u(""))},f=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(F,{className:"w-6 h-6 text-cyan-400"}),"Horaires de disponibilit√©"]}),e.jsx("div",{className:"space-y-3",children:t?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[e.jsx("span",{className:"text-white font-medium",children:f[m.day_of_week]}),e.jsxs("span",{className:"text-gray-400",children:[m.start_time.substring(0,5)," -"," ",m.end_time.substring(0,5)]})]},m.id))})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Q,{className:"w-6 h-6 text-red-400"}),"Dates bloqu√©es"]}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx(_,{type:"date",value:l,onChange:m=>u(m.target.value),className:"flex-1"}),e.jsx(E,{onClick:p,children:"Bloquer"})]}),e.jsx("div",{className:"space-y-2",children:s?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-500/10 rounded-lg border border-red-500/30",children:[e.jsx("span",{className:"text-white",children:new Date(m.blocked_date).toLocaleDateString("fr-FR")}),e.jsx("button",{onClick:()=>i.mutate(m.id),className:"text-red-400 hover:text-red-300",children:"Supprimer"})]},m.id))})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"w-6 h-6 text-purple-400"}),"Param√®tres syst√®me"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(_,{label:"Temps de battement (minutes)",type:"number",value:o.buffer_time,onChange:m=>x({...o,buffer_time:parseInt(m.target.value)}),min:0,max:60}),e.jsx(_,{label:"Dur√©e des cr√©neaux (minutes)",type:"number",value:o.slot_duration,onChange:m=>x({...o,slot_duration:parseInt(m.target.value)}),min:15,max:240}),e.jsx(_,{label:"R√©servation max (jours)",type:"number",value:o.max_advance_days,onChange:m=>x({...o,max_advance_days:parseInt(m.target.value)}),min:1,max:365}),e.jsx(_,{label:"D√©lai minimum (heures)",type:"number",value:o.min_advance_hours,onChange:m=>x({...o,min_advance_hours:parseInt(m.target.value)}),min:1,max:168})]}),e.jsxs(E,{onClick:b,className:"mt-4 flex items-center gap-2",disabled:r.isPending,children:[e.jsx(fe,{className:"w-5 h-5"}),r.isPending?"Sauvegarde...":"Sauvegarder"]})]})]})},zt=()=>{const[t,s]=y.useState("dashboard"),{data:a,isLoading:r}=ze(),{data:n,isLoading:i}=Te(5),{data:l}=Ue(),u=[{id:"dashboard",label:"Dashboard",icon:ve},{id:"list",label:"Liste",icon:we},{id:"calendar",label:"Calendrier",icon:Q},{id:"services",label:"Services",icon:G},{id:"settings",label:"Configuration",icon:ae}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-600 mb-2",children:"Gestion des Rendez-vous"}),e.jsx("p",{className:"text-gray-400",children:"G√©rez vos consultations et configurez votre syst√®me de r√©servation"})]}),e.jsx("div",{className:"mb-8 border-b border-white/10",children:e.jsx("nav",{className:"flex space-x-4 overflow-x-auto",children:u.map(o=>{const x=o.icon;return e.jsxs("button",{onClick:()=>s(o.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-all whitespace-nowrap ${t===o.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600"}`,children:[e.jsx(x,{className:"w-5 h-5"}),o.label]},o.id)})})}),e.jsxs("div",{className:"space-y-6",children:[t==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r?e.jsx("div",{className:"col-span-full",children:e.jsx($,{})}):e.jsxs(e.Fragment,{children:[e.jsx(z,{title:"Total",value:a?.total||0,icon:Q,color:"from-blue-500 to-cyan-500"}),e.jsx(z,{title:"En attente",value:a?.pending||0,icon:F,color:"from-yellow-500 to-orange-500"}),e.jsx(z,{title:"Confirm√©s",value:a?.confirmed||0,icon:ee,color:"from-green-500 to-emerald-500"}),e.jsx(z,{title:"Compl√©t√©s",value:a?.completed||0,icon:je,color:"from-purple-500 to-pink-500"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-gradient-to-r from-red-500/20 to-orange-500/20",children:e.jsx(te,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Annul√©s"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a?.cancelled||0})]})]})}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-gradient-to-r from-gray-500/20 to-gray-600/20",children:e.jsx(U,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Absences"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a?.no_show||0})]})]})})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(F,{className:"w-6 h-6 text-cyan-400"}),"Rendez-vous √† venir"]}),i?e.jsx($,{}):n&&n.length>0?e.jsx("div",{className:"space-y-3",children:n.map(o=>e.jsx(Et,{meeting:o},o.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"Aucun rendez-vous √† venir"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-6 h-6 text-purple-400"}),"Services actifs"]}),l&&l.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(o=>e.jsx(qt,{service:o},o.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"Aucun service actif"})]})]}),t==="list"&&e.jsx(dt,{}),t==="calendar"&&e.jsx(wt,{}),t==="services"&&e.jsx(jt,{}),t==="settings"&&e.jsx(Dt,{})]})]})},z=({title:t,value:s,icon:a,color:r})=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 p-6 hover:bg-white/10 transition-all",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-r ${r} bg-opacity-20`,children:e.jsx(a,{className:"w-6 h-6 text-white"})})}),e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:t}),e.jsx("p",{className:"text-3xl font-bold text-white",children:s})]}),Et=({meeting:t})=>{const s=r=>{switch(r){case"pending":return"bg-yellow-500/20 text-yellow-400";case"confirmed":return"bg-green-500/20 text-green-400";default:return"bg-gray-500/20 text-gray-400"}},a=r=>{switch(r){case"pending":return"En attente";case"confirmed":return"Confirm√©";default:return r}};return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"text-center min-w-[50px]",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:new Date(t.meeting_date).getDate()}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.meeting_date).toLocaleDateString("fr-FR",{month:"short"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-medium truncate",children:t.client_name}),e.jsx("p",{className:"text-sm text-gray-400 truncate",children:t.meeting_services?.name||"Service non d√©fini"})]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("p",{className:"text-white font-medium whitespace-nowrap",children:t.meeting_time.substring(0,5)}),e.jsx("span",{className:`text-xs px-2 py-1 rounded whitespace-nowrap ${s(t.status)}`,children:a(t.status)})]})]})},qt=({service:t})=>e.jsx("div",{className:"p-4 rounded-lg border border-white/10 hover:bg-white/5 transition-all",style:{borderColor:t.color+"40"},children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:t.color+"20"},children:e.jsx(F,{className:"w-5 h-5",style:{color:t.color}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-medium text-sm truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[t.duration," min"]})]})]})});export{E as B,ct as E,_ as I,P as M,re as T,Ue as a,pt as b,bt as c,kt as d,Ee as e,Tt as f,zt as g,$e as u};
